<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>TICO IA | Plataforma de Agentes Inteligentes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

    <style>
        /* ==================== SISTEMA DE TEMAS ==================== */
        :root[data-theme="dark"] {
            --bg-primary: #0a0a0a;
            --bg-secondary: #171717;
            --bg-tertiary: #262626;
            --bg-card: rgba(23, 23, 23, 0.7);
            --bg-input: #171717;
            --text-primary: #ffffff;
            --text-secondary: #d4d4d4;
            --text-tertiary: #737373;
            --border-light: rgba(255, 255, 255, 0.08);
            --border-medium: rgba(255, 255, 255, 0.12);
            --glass-bg: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(255, 255, 255, 0.08);
            --accent-glow: rgba(255, 255, 255, 0.15);
            --shadow-color: rgba(0, 0, 0, 0.5);
            --chart-grid: rgba(255, 255, 255, 0.05);
        }

        :root[data-theme="light"] {
            --bg-primary: #f5f5f5;
            --bg-secondary: #ffffff;
            --bg-tertiary: #e5e5e5;
            --bg-card: rgba(255, 255, 255, 0.8);
            --bg-input: #ffffff;
            --text-primary: #171717;
            --text-secondary: #404040;
            --text-tertiary: #737373;
            --border-light: rgba(0, 0, 0, 0.08);
            --border-medium: rgba(0, 0, 0, 0.12);
            --glass-bg: rgba(0, 0, 0, 0.02);
            --glass-border: rgba(0, 0, 0, 0.08);
            --accent-glow: rgba(0, 0, 0, 0.05);
            --shadow-color: rgba(0, 0, 0, 0.1);
            --chart-grid: rgba(0, 0, 0, 0.05);
        }

        :root {
            --pure-white: #ffffff;
            --pure-black: #000000;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            --sidebar-width: 280px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --transition-base: 250ms cubic-bezier(0.4, 0, 0.2, 1);
            --chart-color-1: #3b82f6;
            --chart-color-2: #10b981;
            --chart-color-3: #f59e0b;
            --chart-color-4: #ef4444;
            --chart-color-5: #8b5cf6;
            --chart-color-6: #ec4899;
        }

        /* ==================== RESET E BASE ==================== */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { font-size: clamp(14px, 2vw, 16px); scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
            transition: background-color var(--transition-base), color var(--transition-base);
        }

        .bg-mesh {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at 20% 30%, var(--accent-glow) 0%, transparent 40%),
                        radial-gradient(circle at 80% 70%, var(--accent-glow) 0%, transparent 40%);
            z-index: -1;
            pointer-events: none;
        }

        /* ==================== COMPONENTES ==================== */
        .glass {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-md);
            box-shadow: 0 4px 20px var(--shadow-color);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: clamp(0.5rem, 2vw, 0.75rem) clamp(1rem, 3vw, 1.5rem);
            border-radius: var(--radius-md);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-base);
            border: none;
            gap: 0.5rem;
            font-size: clamp(0.75rem, 1.5vw, 0.9rem);
            white-space: nowrap;
        }

        .btn-primary { background: var(--text-primary); color: var(--bg-primary); }
        .btn-primary:hover { transform: translateY(-2px); opacity: 0.9; }
        .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .btn-outline { background: transparent; border: 1px solid var(--border-medium); color: var(--text-primary); }
        .btn-outline:hover { background: var(--glass-bg); border-color: var(--text-primary); }
        .btn-danger { background: var(--error); color: white; }
        .btn-danger:hover { opacity: 0.9; transform: translateY(-2px); }

        .input-group { margin-bottom: clamp(0.75rem, 2vw, 1.25rem); position: relative; text-align: left; }
        .input-group label { display: block; margin-bottom: 0.5rem; font-size: clamp(0.7rem, 1.5vw, 0.85rem); color: var(--text-secondary); font-weight: 500; }
        .input-field {
            width: 100%;
            padding: clamp(0.6rem, 1.5vw, 0.85rem) clamp(0.75rem, 2vw, 1rem);
            background: var(--bg-input);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            transition: all var(--transition-base);
            font-family: inherit;
            font-size: clamp(0.8rem, 1.5vw, 0.95rem);
        }
        .input-field:focus { outline: none; border-color: var(--text-primary); background: var(--bg-secondary); }
        .input-field.invalid { border-color: var(--error); }

        .password-wrapper { position: relative; }
        .toggle-password { position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); cursor: pointer; color: var(--text-tertiary); z-index: 10; }

        .password-requirements {
            margin-top: 0.75rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 0.5rem;
            padding: 0.75rem;
            background: var(--bg-secondary);
            border-radius: 8px;
            font-size: clamp(0.6rem, 1.2vw, 0.7rem);
        }
        .requirement { display: flex; align-items: center; gap: 0.4rem; color: var(--text-tertiary); }
        .requirement.met { color: var(--success); }

        /* ==================== THEME TOGGLE ==================== */
        .theme-toggle {
            position: fixed;
            bottom: clamp(1rem, 3vw, 2rem);
            right: clamp(1rem, 3vw, 2rem);
            width: clamp(40px, 10vw, 50px);
            height: clamp(40px, 10vw, 50px);
            border-radius: 50%;
            background: var(--text-primary);
            color: var(--bg-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 20px var(--shadow-color);
            z-index: 1000;
            transition: transform 0.3s ease;
        }
        .theme-toggle:hover { transform: scale(1.1); }

        /* ==================== LOADING SCREEN ==================== */
        #loadingScreen {
            position: fixed;
            inset: 0;
            background: var(--bg-primary);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        .loader {
            width: 48px;
            height: 48px;
            border: 3px solid var(--bg-tertiary);
            border-bottom-color: var(--text-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* ==================== AUTH VIEWS - MOBILE FIRST ==================== */
        .auth-view {
            min-height: 100vh;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: clamp(0.5rem, 2vw, 2rem);
            position: relative;
            z-index: 10;
        }

        .auth-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: clamp(1.5rem, 4vw, 5rem);
            max-width: 1300px;
            width: 100%;
            animation: fadeIn 0.6s ease-out;
        }

        .auth-info {
            flex: 1.2;
            text-align: center;
            order: 2;
            width: 100%;
        }
        .auth-info h2 { 
            font-size: clamp(1.5rem, 5vw, 3.5rem); 
            font-weight: 900; 
            letter-spacing: -1px; 
            line-height: 1.1; 
            margin-bottom: 1rem; 
        }
        .auth-info p { 
            font-size: clamp(0.9rem, 2.5vw, 1.3rem); 
            color: var(--text-secondary); 
            max-width: 550px; 
            border-left: 4px solid var(--text-primary); 
            padding-left: clamp(1rem, 3vw, 2rem);
            margin: 0 auto;
        }

        .auth-card {
            width: 100%;
            max-width: 500px;
            padding: clamp(1.5rem, 4vw, 3.5rem);
            text-align: center;
            order: 1;
        }

        .auth-header { margin-bottom: clamp(1rem, 2.5vw, 2rem); }
        .auth-header i { font-size: clamp(2rem, 6vw, 3.5rem); margin-bottom: 1rem; color: var(--text-primary); }
        .auth-header h1 { font-size: clamp(1.3rem, 3.5vw, 2.2rem); font-weight: 800; letter-spacing: -1px; margin-bottom: 0.5rem; }
        .auth-header p { color: var(--text-secondary); font-size: clamp(0.8rem, 2vw, 1rem); }

        .code-inputs { 
            display: flex; 
            gap: clamp(0.3rem, 1vw, 0.75rem); 
            justify-content: center; 
            margin: clamp(1rem, 2.5vw, 2rem) 0;
            flex-wrap: wrap;
        }
        .code-input { 
            width: clamp(35px, 8vw, 50px); 
            height: clamp(45px, 10vw, 60px); 
            text-align: center; 
            font-size: clamp(1rem, 2.5vw, 1.5rem); 
            font-weight: 800; 
            border-radius: 12px; 
            background: var(--bg-input); 
            border: 1px solid var(--border-light); 
            color: var(--text-primary); 
        }
        .code-input:focus { border-color: var(--text-primary); outline: none; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* ==================== DASHBOARD LAYOUT - MOBILE FIRST ==================== */
        .dashboard-view { display: none; min-height: 100vh; }
        
        .sidebar {
            width: var(--sidebar-width);
            height: 100vh;
            position: fixed;
            left: 0; top: 0;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-light);
            display: flex;
            flex-direction: column;
            z-index: 100;
            transition: transform 0.3s ease;
            overflow-y: auto;
        }

        .sidebar-header { 
            padding: clamp(1rem, 2.5vw, 2rem) clamp(0.75rem, 1.5vw, 1.5rem); 
            display: flex; 
            align-items: center; 
            gap: 0.75rem; 
            border-bottom: 1px solid var(--border-light); 
        }
        .sidebar-header h2 { font-size: clamp(0.9rem, 2vw, 1.2rem); font-weight: 800; }

        .sidebar-nav { flex: 1; padding: clamp(0.75rem, 1.5vw, 1.5rem) 0; overflow-y: auto; }
        .nav-link {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: clamp(0.5rem, 1.2vw, 0.85rem) clamp(0.75rem, 1.5vw, 1.5rem);
            color: var(--text-secondary);
            text-decoration: none;
            transition: all var(--transition-base);
            border-left: 3px solid transparent;
            cursor: pointer;
            font-size: clamp(0.75rem, 1.5vw, 0.9rem);
        }
        .nav-link:hover, .nav-link.active { color: var(--text-primary); background: var(--glass-bg); }
        .nav-link.active { border-left-color: var(--text-primary); }

        .main-content { 
            margin-left: var(--sidebar-width); 
            padding: clamp(0.75rem, 2vw, 2rem); 
            min-height: 100vh; 
        }

        .top-bar { 
            display: flex; 
            justify-content: space-between; 
            align-items: flex-start;
            margin-bottom: clamp(1rem, 2.5vw, 2.5rem); 
            gap: clamp(0.5rem, 1.5vw, 1rem); 
            flex-wrap: wrap;
        }
        .top-bar > div:first-child h1 { font-size: clamp(1.3rem, 3.5vw, 2rem); }
        .top-bar > div:first-child p { font-size: clamp(0.7rem, 1.5vw, 0.85rem); }
        
        .stats-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(clamp(140px, 35vw, 240px), 1fr)); 
            gap: clamp(0.75rem, 1.5vw, 1.5rem); 
            margin-bottom: clamp(1rem, 2.5vw, 2.5rem); 
        }
        .stat-card { 
            padding: clamp(0.75rem, 1.5vw, 1.5rem);
            position: relative;
            overflow: hidden;
        }
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--chart-color-1), var(--chart-color-2));
        }
        .stat-card h3 { 
            font-size: clamp(0.65rem, 1.2vw, 0.85rem); 
            color: var(--text-tertiary); 
            text-transform: uppercase; 
            letter-spacing: 1px; 
            margin-bottom: 0.5rem; 
        }
        .stat-card .value { 
            font-size: clamp(1.3rem, 3.5vw, 2rem); 
            font-weight: 800; 
            margin-bottom: 0.25rem;
        }
        .stat-card .trend {
            font-size: clamp(0.6rem, 1.1vw, 0.7rem);
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        .stat-card .trend.positive { color: var(--success); }
        .stat-card .trend.negative { color: var(--error); }

        .charts-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(clamp(280px, 100%, 500px), 1fr)); 
            gap: clamp(0.75rem, 1.5vw, 1.5rem); 
            margin-bottom: clamp(1rem, 2.5vw, 2.5rem); 
        }
        
        .chart-container {
            position: relative;
            height: 250px;
            width: 100%;
        }

        /* ==================== CHAT INTERFACE - MOBILE FIRST ==================== */
        .chat-container { 
            display: grid; 
            grid-template-columns: 1fr; 
            height: calc(100vh - 180px); 
            gap: 1px; 
            background: var(--border-light); 
            border-radius: var(--radius-lg); 
            overflow: hidden; 
        }
        .chat-sidebar { 
            background: var(--bg-secondary); 
            display: none;
            flex-direction: column; 
            border-bottom: 1px solid var(--border-light);
            max-height: 200px;
        }
        .chat-sidebar.open { display: flex; }
        .chat-list { 
            flex: 1; 
            overflow-y: auto; 
            display: flex;
            gap: 0.5rem;
            padding: 0.5rem;
        }
        .chat-item { 
            padding: clamp(0.6rem, 1.5vw, 1.25rem); 
            border-radius: var(--radius-md);
            cursor: pointer; 
            transition: background 0.2s; 
            display: flex; 
            align-items: center; 
            gap: 0.75rem;
            flex-shrink: 0;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            font-size: clamp(0.7rem, 1.5vw, 0.85rem);
        }
        .chat-item:hover, .chat-item.active { background: var(--glass-bg); color: var(--text-primary); }
        .chat-item i { font-size: clamp(1rem, 2vw, 1.2rem); }
        
        .chat-main { background: var(--bg-primary); display: flex; flex-direction: column; position: relative; }
        .chat-header { 
            padding: clamp(0.6rem, 1.5vw, 1rem) clamp(0.75rem, 1.5vw, 1.5rem); 
            border-bottom: 1px solid var(--border-light); 
            display: flex; 
            justify-content: space-between; 
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }
        .chat-header > div:first-child { display: flex; align-items: center; gap: clamp(0.5rem, 1.5vw, 1rem); }
        .chat-header p { font-size: clamp(0.7rem, 1.5vw, 0.9rem); }
        
        .chat-messages { 
            flex: 1; 
            padding: clamp(0.75rem, 1.5vw, 1.5rem); 
            overflow-y: auto; 
            display: flex; 
            flex-direction: column; 
            gap: clamp(0.6rem, 1.2vw, 1rem); 
        }
        .message { 
            max-width: 85%; 
            padding: clamp(0.6rem, 1.2vw, 1rem); 
            border-radius: var(--radius-md); 
            font-size: clamp(0.8rem, 1.5vw, 0.95rem); 
            position: relative; 
        }
        .message.user { align-self: flex-end; background: var(--text-primary); color: var(--bg-primary); border-bottom-right-radius: 2px; }
        .message.bot { align-self: flex-start; background: var(--bg-secondary); border: 1px solid var(--border-light); border-bottom-left-radius: 2px; }
        .message-info { font-size: clamp(0.6rem, 1.2vw, 0.7rem); opacity: 0.7; margin-top: 0.5rem; display: block; }
        
        .chat-input-area { 
            padding: clamp(0.75rem, 1.5vw, 1.5rem); 
            border-top: 1px solid var(--border-light); 
        }
        .chat-input-wrapper { 
            display: flex; 
            gap: clamp(0.4rem, 1vw, 0.75rem); 
            align-items: center; 
            background: var(--bg-input); 
            padding: clamp(0.4rem, 1vw, 0.5rem); 
            border-radius: var(--radius-md); 
            border: 1px solid var(--border-light);
            flex-wrap: wrap;
        }
        .chat-input-wrapper input { 
            flex: 1; 
            background: transparent; 
            border: none; 
            color: var(--text-primary); 
            padding: clamp(0.4rem, 1vw, 0.5rem); 
            font-family: inherit;
            font-size: clamp(0.8rem, 1.5vw, 0.95rem);
            min-width: 120px;
        }
        .chat-input-wrapper input:focus { outline: none; }

        /* ==================== SETTINGS ENHANCED ==================== */
        .settings-layout { 
            display: grid; 
            grid-template-columns: 1fr;
            gap: clamp(1rem, 2.5vw, 2rem); 
        }
        .settings-nav { 
            display: flex; 
            flex-direction: row;
            gap: clamp(0.4rem, 1vw, 0.5rem);
            overflow-x: auto;
            padding-bottom: 0.5rem;
            -webkit-overflow-scrolling: touch;
        }
        .settings-nav-btn { 
            padding: clamp(0.5rem, 1.2vw, 0.75rem) clamp(0.6rem, 1.5vw, 1rem); 
            border-radius: var(--radius-md); 
            cursor: pointer; 
            transition: all 0.2s; 
            color: var(--text-secondary); 
            display: flex; 
            align-items: center; 
            gap: clamp(0.4rem, 1vw, 0.75rem);
            font-size: clamp(0.7rem, 1.5vw, 0.85rem);
            white-space: nowrap;
        }
        .settings-nav-btn:hover { background: var(--glass-bg); color: var(--text-primary); }
        .settings-nav-btn.active { background: var(--text-primary); color: var(--bg-primary); }
        
        .settings-section { display: none; animation: fadeIn 0.3s ease; }
        .settings-section.active { display: block; }
        
        .settings-card { 
            padding: clamp(1rem, 2.5vw, 2rem); 
            margin-bottom: clamp(0.75rem, 1.5vw, 1.5rem); 
        }
        .settings-card h2 { 
            font-size: clamp(0.9rem, 2vw, 1.25rem); 
            margin-bottom: clamp(0.75rem, 1.5vw, 1.5rem); 
            display: flex; 
            align-items: center; 
            gap: 0.75rem; 
        }
        
        .toggle-switch { position: relative; display: inline-block; width: 50px; height: 24px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--bg-tertiary); transition: .4s; border-radius: 24px; }
        .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--success); }
        input:checked + .slider:before { transform: translateX(26px); }

        .setting-item { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding: clamp(0.6rem, 1.2vw, 1rem) 0; 
            border-bottom: 1px solid var(--border-light);
            gap: 1rem;
            flex-wrap: wrap;
        }
        .setting-item:last-child { border-bottom: none; }
        .setting-info h4 { font-size: clamp(0.8rem, 1.5vw, 0.95rem); margin-bottom: 0.25rem; }
        .setting-info p { font-size: clamp(0.7rem, 1.2vw, 0.8rem); color: var(--text-tertiary); }

        /* ==================== MODALS & NOTIFICATIONS ==================== */
        .modal-overlay { 
            position: fixed; 
            inset: 0; 
            background: rgba(0,0,0,0.8); 
            backdrop-filter: blur(4px); 
            display: none; 
            align-items: center; 
            justify-content: center; 
            z-index: 2000; 
            padding: clamp(0.75rem, 2vw, 2rem);
        }
        .modal-content { 
            width: 100%; 
            max-width: 500px; 
            padding: clamp(1rem, 2.5vw, 2.5rem); 
            position: relative; 
            animation: modalIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); 
            max-height: 90vh;
            overflow-y: auto;
        }
        @keyframes modalIn { from { opacity: 0; transform: scale(0.9) translateY(20px); } to { opacity: 1; transform: scale(1) translateY(0); } }
        
        #notificationContainer { 
            position: fixed; 
            top: clamp(0.75rem, 2vw, 2rem); 
            right: clamp(0.75rem, 2vw, 2rem); 
            z-index: 9999; 
            display: flex; 
            flex-direction: column; 
            gap: 0.75rem; 
            pointer-events: none;
            max-width: calc(100% - 1.5rem);
        }
        .notification { 
            padding: clamp(0.6rem, 1.2vw, 1rem) clamp(0.75rem, 1.5vw, 1.5rem); 
            border-radius: var(--radius-md); 
            background: var(--bg-secondary); 
            border: 1px solid var(--border-light); 
            color: var(--text-primary); 
            box-shadow: 0 10px 30px rgba(0,0,0,0.3); 
            display: flex; 
            align-items: center; 
            gap: clamp(0.6rem, 1.2vw, 1rem); 
            animation: slideIn 0.3s ease-out; 
            pointer-events: auto; 
            min-width: clamp(250px, 90vw, 350px);
            font-size: clamp(0.8rem, 1.5vw, 0.9rem);
        }
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        .notification.success { border-left: 4px solid var(--success); }
        .notification.error { border-left: 4px solid var(--error); }
        .notification.info { border-left: 4px solid var(--info); }

        /* ==================== TABLES - RESPONSIVE ==================== */
        .table-responsive { 
            overflow-x: auto; 
            -webkit-overflow-scrolling: touch;
        }
        table { 
            width: 100%; 
            border-collapse: collapse; 
            text-align: left;
            font-size: clamp(0.75rem, 1.5vw, 0.9rem);
        }
        th { 
            padding: clamp(0.6rem, 1.2vw, 1rem); 
            font-size: clamp(0.65rem, 1.2vw, 0.75rem); 
            text-transform: uppercase; 
            color: var(--text-tertiary); 
            border-bottom: 1px solid var(--border-light);
            white-space: nowrap;
        }
        td { 
            padding: clamp(0.6rem, 1.2vw, 1rem); 
            border-bottom: 1px solid var(--border-light);
        }
        .status-badge { 
            padding: clamp(0.2rem, 0.5vw, 0.25rem) clamp(0.5rem, 1vw, 0.75rem); 
            border-radius: 20px; 
            font-size: clamp(0.6rem, 1vw, 0.7rem); 
            font-weight: 700; 
            text-transform: uppercase;
            display: inline-block;
        }
        .status-online { background: rgba(16, 185, 129, 0.1); color: var(--success); }
        .status-offline { background: rgba(115, 115, 115, 0.1); color: var(--text-tertiary); }

        .supervisor-tag { 
            background: var(--text-primary); 
            color: var(--bg-primary); 
            font-size: clamp(0.5rem, 1vw, 0.6rem); 
            font-weight: 900; 
            padding: 2px 6px; 
            border-radius: 4px; 
            margin-right: 8px; 
            vertical-align: middle;
            display: inline-block;
        }

        /* ==================== RESPONSIVE BREAKPOINTS ==================== */
        @media (max-width: 1024px) {
            .sidebar { 
                width: 100%;
                height: auto;
                position: relative;
                border-right: none;
                border-bottom: 1px solid var(--border-light);
                flex-direction: row;
                padding: 0;
            }
            .sidebar-header { 
                padding: 0.75rem 1rem; 
                flex-shrink: 0;
            }
            .sidebar-nav { 
                flex: 1; 
                padding: 0.5rem; 
                display: flex;
                overflow-x: auto;
                gap: 0.5rem;
                -webkit-overflow-scrolling: touch;
            }
            .nav-link { 
                padding: 0.5rem 1rem;
                border-left: none;
                border-bottom: 3px solid transparent;
                flex-shrink: 0;
            }
            .nav-link.active { 
                border-left: none;
                border-bottom-color: var(--text-primary);
            }
            .main-content { 
                margin-left: 0; 
                padding: clamp(0.75rem, 1.5vw, 1.5rem); 
            }
            
            .auth-container { 
                flex-direction: column; 
                gap: 1.5rem; 
            }
            .auth-info { 
                order: 1; 
                padding: 0 1rem;
            }
            .auth-card { 
                order: 2; 
                max-width: 100%;
            }

            .charts-grid { 
                grid-template-columns: 1fr; 
            }

            .settings-layout { 
                grid-template-columns: 1fr; 
            }
            .settings-nav { 
                flex-direction: row; 
                overflow-x: auto; 
            }

            .chat-container { 
                grid-template-columns: 1fr; 
                height: calc(100vh - 200px);
            }
            .chat-sidebar { 
                display: flex;
                max-height: 150px;
            }
            
            .chart-container {
                height: 220px;
            }
        }

        @media (max-width: 768px) {
            html { font-size: 14px; }
            
            .stats-grid { 
                grid-template-columns: repeat(2, 1fr); 
            }
            
            .top-bar { 
                flex-direction: column;
                align-items: stretch;
            }
            .top-bar > div:last-child { 
                display: flex;
                flex-direction: column;
                gap: 0.5rem;
            }

            .message { 
                max-width: 90%; 
            }
            
            .settings-card { 
                padding: 1.25rem; 
            }
            
            .modal-content { 
                max-width: 90%; 
                padding: 1.25rem;
            }

            .sidebar-nav { 
                gap: 0.25rem; 
            }
            .nav-link { 
                padding: 0.5rem 0.75rem; 
                font-size: 0.75rem; 
            }
            .nav-link i { 
                font-size: 1rem; 
            }

            .table-responsive { 
                font-size: 0.8rem; 
            }
            th, td { 
                padding: 0.5rem; 
            }
            
            .chart-container {
                height: 200px;
            }
            
            .code-inputs {
                gap: 0.5rem;
            }
            .code-input {
                width: 40px;
                height: 50px;
                font-size: 1.2rem;
            }
        }

        @media (max-width: 480px) {
            html { font-size: 13px; }
            
            .stats-grid { 
                grid-template-columns: 1fr; 
            }
            
            .sidebar { 
                flex-wrap: wrap;
                height: auto;
            }
            .sidebar-header { 
                width: 100%;
                padding: 0.75rem;
                justify-content: center;
            }
            .sidebar-nav { 
                width: 100%;
                overflow-x: auto;
                justify-content: flex-start;
            }

            .top-bar { 
                gap: 0.5rem; 
            }
            .top-bar h1 { 
                font-size: 1.25rem; 
            }

            .code-inputs { 
                gap: 0.3rem; 
            }
            .code-input { 
                width: 35px; 
                height: 45px; 
                font-size: 1.1rem;
            }

            .message { 
                max-width: 95%; 
            }
            .chat-header { 
                flex-direction: column; 
                align-items: flex-start; 
            }

            .chat-item { 
                padding: 0.5rem;
                font-size: 0.65rem;
            }
            .chat-item i { 
                font-size: 0.9rem; 
            }

            .settings-nav-btn { 
                padding: 0.4rem 0.6rem;
                font-size: 0.65rem;
            }

            .modal-content { 
                padding: 1rem;
                max-width: 95%;
            }

            .notification { 
                min-width: calc(100vw - 2rem);
                font-size: 0.75rem;
            }

            .table-responsive { 
                font-size: 0.7rem; 
            }
            th, td { 
                padding: 0.4rem; 
            }
            
            .btn { 
                padding: 0.5rem 1rem;
                font-size: 0.75rem;
            }
            
            .auth-card {
                padding: 1.25rem;
            }
            
            .auth-info h2 {
                font-size: 1.75rem;
            }
            
            .auth-info p {
                font-size: 0.9rem;
                padding-left: 1rem;
            }
            
            .chart-container {
                height: 180px;
            }
        }

        @media (max-width: 360px) {
            html { font-size: 12px; }
            
            .code-input { 
                width: 30px; 
                height: 40px; 
                font-size: 1rem; 
            }
            .code-inputs { 
                gap: 0.2rem; 
            }

            .sidebar-header h2 { 
                display: none; 
            }
            .nav-link { 
                padding: 0.4rem 0.5rem; 
            }
            .nav-link span { 
                display: none; 
            }
            .nav-link i { 
                margin: 0; 
                font-size: 0.9rem;
            }

            .stats-grid { 
                gap: 0.75rem; 
            }
            .stat-card { 
                padding: 0.75rem; 
            }

            .message { 
                max-width: 100%; 
                padding: 0.5rem;
                font-size: 0.8rem;
            }
            
            .chat-container {
                height: calc(100vh - 160px);
            }
            
            .auth-card {
                padding: 1rem;
            }
            
            .auth-header h1 {
                font-size: 1.1rem;
            }
            
            .chart-container {
                height: 160px;
            }
        }

        /* ==================== PRINT STYLES ==================== */
        @media print {
            .sidebar, .theme-toggle, .top-bar button, #notificationContainer { display: none; }
            .main-content { margin-left: 0; }
            .glass { box-shadow: none; border: 1px solid #ddd; }
        }
    </style>
</head>
<body>
    <div class="bg-mesh"></div>

    <div id="loadingScreen">
        <div class="loader"></div>
        <p style="font-weight: 600; letter-spacing: 2px;">TICO IA</p>
    </div>

    <div id="themeToggle" class="theme-toggle" onclick="TicoApp.toggleTheme()">
        <i class="fas fa-sun"></i>
    </div>

    <!-- Auth Views -->
    <div id="authViews">
        <!-- Login View -->
        <div id="loginView" class="auth-view">
            <div class="auth-container">
                <div class="auth-info">
                    <h2>Sua Operação,<br>Mais Inteligente.</h2>
                    <p>A plataforma definitiva para orquestração de agentes de IA em escala corporativa.</p>
                </div>
                <div class="auth-card glass">
                    <div class="auth-header">
                        <i class="fas fa-robot"></i>
                        <h1>TICO IA</h1>
                        <p>Acesse sua central de agentes</p>
                    </div>
                    <form id="loginForm">
                        <div class="input-group">
                            <label>E-mail Corporativo</label>
                            <input type="email" class="input-field" id="email" placeholder="exemplo@empresa.com" required>
                        </div>
                        <div class="input-group">
                            <label>Senha</label>
                            <div class="password-wrapper">
                                <input type="password" class="input-field" id="password" placeholder="••••••••" required>
                                <i class="fas fa-eye toggle-password" data-target="password"></i>
                            </div>
                        </div>
                        <div style="text-align: right; margin-bottom: 1rem;">
                            <a href="#" id="toReset" style="color: var(--text-tertiary); font-size: clamp(0.65rem, 1.2vw, 0.8rem); text-decoration: none;">Esqueceu a senha?</a>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%;">
                            Entrar <i class="fas fa-arrow-right"></i>
                        </button>
                    </form>
                    <div style="text-align: center; margin-top: 1.5rem;">
                        <p style="font-size: clamp(0.65rem, 1.2vw, 0.8rem); color: var(--text-tertiary);">
                            Não tem uma conta? <a href="#" id="toRegister" style="color: var(--text-primary); text-decoration: none; font-weight: 600;">Solicitar Acesso</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Register View -->
        <div id="registerView" class="auth-view" style="display: none;">
            <div class="auth-container">
                <div class="auth-info">
                    <h2>Inteligência sob Governança</h2>
                    <p>Acesso restrito a colaboradores autorizados. Cada ação é auditada via Safe Learning Loop.</p>
                </div>
                <div class="auth-card glass">
                    <div class="auth-header">
                        <i class="fas fa-user-plus"></i>
                        <h1>CRIAR CONTA</h1>
                        <p>Junte-se à revolução da IA</p>
                    </div>
                    <form id="registerForm">
                        <div class="input-group">
                            <label>Nome Completo</label>
                            <input type="text" class="input-field" id="regName" placeholder="Seu nome" required>
                        </div>
                        <div class="input-group">
                            <label>CPF</label>
                            <input type="text" class="input-field" id="regCpf" placeholder="000.000.000-00" maxlength="14" required>
                        </div>
                        <div class="input-group">
                            <label>Setor</label>
                            <select class="input-field" id="regSector" required>
                                <option value="" disabled selected>Selecione seu setor</option>
                                <option value="RH">RH</option><option value="TI">TI</option><option value="DP">DP</option><option value="ENGENHARIA">ENGENHARIA</option>
                                <option value="FINANCEIRO">FINANCEIRO</option><option value="SUPRIMENTOS">SUPRIMENTOS</option><option value="SMS">SMS</option><option value="ADMINISTRATIVO">ADMINISTRATIVO</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>E-mail Corporativo</label>
                            <input type="email" class="input-field" id="regEmail" placeholder="exemplo@empresa.com" required>
                        </div>
                        <div class="input-group">
                            <label>Senha</label>
                            <div class="password-wrapper">
                                <input type="password" class="input-field" id="regPassword" placeholder="Crie uma senha forte" required>
                                <i class="fas fa-eye toggle-password" data-target="regPassword"></i>
                            </div>
                            <div class="password-requirements">
                                <div class="requirement" data-req="uppercase"><i class="fas fa-circle"></i> Maiúscula</div>
                                <div class="requirement" data-req="lowercase"><i class="fas fa-circle"></i> Minúscula</div>
                                <div class="requirement" data-req="number"><i class="fas fa-circle"></i> Número</div>
                                <div class="requirement" data-req="special"><i class="fas fa-circle"></i> Especial</div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary" id="regSubmit" style="width: 100%; margin-top: 1rem;" disabled>
                            Verificar E-mail <i class="fas fa-envelope"></i>
                        </button>
                    </form>
                    <div style="text-align: center; margin-top: 1.5rem;">
                        <p style="font-size: clamp(0.65rem, 1.2vw, 0.8rem); color: var(--text-tertiary);">
                            Já possui acesso? <a href="#" id="toLoginFromReg" style="color: var(--text-primary); text-decoration: none; font-weight: 600;">Fazer Login</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Email Verification View -->
        <div id="verifyView" class="auth-view" style="display: none;">
            <div class="auth-card glass">
                <div class="auth-header">
                    <i class="fas fa-shield-check"></i>
                    <h1>VERIFICAÇÃO</h1>
                    <p>Insira o código de 6 dígitos enviado ao seu e-mail</p>
                </div>
                <div class="code-inputs">
                    <input type="text" class="code-input" maxlength="1" data-index="0">
                    <input type="text" class="code-input" maxlength="1" data-index="1">
                    <input type="text" class="code-input" maxlength="1" data-index="2">
                    <input type="text" class="code-input" maxlength="1" data-index="3">
                    <input type="text" class="code-input" maxlength="1" data-index="4">
                    <input type="text" class="code-input" maxlength="1" data-index="5">
                </div>
                <button class="btn btn-primary" id="verifyBtn" style="width: 100%;">Confirmar Código</button>
                <div style="text-align: center; margin-top: 1.5rem;">
                    <p style="font-size: clamp(0.65rem, 1.2vw, 0.8rem); color: var(--text-tertiary);">Não recebeu? <a href="#" style="color: var(--text-primary); font-weight: 600;">Reenviar código</a></p>
                </div>
            </div>
        </div>

        <!-- Reset Password View -->
        <div id="resetView" class="auth-view" style="display: none;">
            <div class="auth-card glass">
                <div class="auth-header">
                    <i class="fas fa-key"></i>
                    <h1>REDEFINIR SENHA</h1>
                    <p>Enviaremos um link de recuperação</p>
                </div>
                <form id="resetForm">
                    <div class="input-group">
                        <label>E-mail Corporativo</label>
                        <input type="email" class="input-field" id="resetEmail" placeholder="exemplo@empresa.com" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 1rem;">
                        Enviar Link <i class="fas fa-paper-plane"></i>
                    </button>
                </form>
                <div style="text-align: center; margin-top: 1.5rem;">
                    <p style="font-size: clamp(0.65rem, 1.2vw, 0.8rem); color: var(--text-tertiary);">
                        Lembrou a senha? <a href="#" id="toLoginFromReset" style="color: var(--text-primary); text-decoration: none; font-weight: 600;">Voltar ao Login</a>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Dashboard -->
    <div id="dashboardView" class="dashboard-view">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <i class="fas fa-robot" style="font-size: clamp(1rem, 2vw, 1.5rem);"></i>
                <h2>TICO IA</h2>
            </div>
            <nav class="sidebar-nav">
                <a class="nav-link active" data-view="main"><i class="fas fa-th-large"></i> <span>Dashboard</span></a>
                <a class="nav-link" data-view="chat"><i class="fas fa-comments"></i> <span>Mensagens</span></a>
                <a class="nav-link" data-view="agents"><i class="fas fa-users-cog"></i> <span>Agentes</span></a>
                <a class="nav-link" data-view="users"><i class="fas fa-user-shield"></i> <span>Usuários</span></a>
                <a class="nav-link" data-view="logs"><i class="fas fa-history"></i> <span>Logs</span></a>
                <a class="nav-link" data-view="chat-logs"><i class="fas fa-comments"></i> <span>Auditoria</span></a>
                <a class="nav-link" data-view="settings"><i class="fas fa-cog"></i> <span>Config</span></a>
            </nav>
            <div style="padding: clamp(0.75rem, 1.5vw, 1.5rem); border-top: 1px solid var(--border-light);">
                <button class="btn btn-outline" id="logoutBtn" style="width: 100%; font-size: clamp(0.7rem, 1.5vw, 0.85rem);"><i class="fas fa-sign-out-alt"></i> <span>Sair</span></button>
            </div>
        </div>

        <main class="main-content">
            <!-- Dashboard Content -->
            <div id="view-main">
                <header class="top-bar">
                    <div>
                        <h1>Olá, <span class="user-name-display">Usuário</span></h1>
                        <p>Resumo da sua operação hoje.</p>
                    </div>
                    <div style="display: flex; gap: clamp(0.5rem, 1.5vw, 1rem); align-items: center; flex-wrap: wrap;">
                        <button class="btn btn-outline" id="exportCsvBtn"><i class="fas fa-file-export"></i> <span>Exportar</span></button>
                        <div class="glass" style="padding: clamp(0.4rem, 1vw, 0.5rem) clamp(0.75rem, 1.5vw, 1rem); display: flex; align-items: center; gap: clamp(0.5rem, 1.5vw, 1rem); flex-wrap: wrap;">
                            <div style="text-align: right;">
                                <p style="font-size: clamp(0.7rem, 1.5vw, 0.8rem); font-weight: 600;" id="companyDisplay">Setor Demo</p>
                                <p style="font-size: clamp(0.6rem, 1.2vw, 0.7rem); color: var(--text-tertiary);">Plano Enterprise</p>
                            </div>
                            <img src="https://ui-avatars.com/api/?name=User&background=random" class="user-avatar-display" style="width: clamp(30px, 6vw, 35px); height: clamp(30px, 6vw, 35px); border-radius: 50%; border: 2px solid var(--text-primary);">
                        </div>
                    </div>
                </header>

                <div class="stats-grid">
                    <div class="stat-card glass">
                        <h3>Agentes Ativos</h3>
                        <div class="value">12</div>
                        <div class="trend positive"><i class="fas fa-arrow-up"></i> 2 esta semana</div>
                    </div>
                    <div class="stat-card glass">
                        <h3>Requisições</h3>
                        <div class="value">8.4k</div>
                        <div class="trend positive"><i class="fas fa-arrow-up"></i> 15% vs semana passada</div>
                    </div>
                    <div class="stat-card glass">
                        <h3>Economia</h3>
                        <div class="value">R$ 42k</div>
                        <div class="trend positive"><i class="fas fa-arrow-up"></i> R$ 8k este mês</div>
                    </div>
                    <div class="stat-card glass">
                        <h3>Tempo Médio</h3>
                        <div class="value">1.2s</div>
                        <div class="trend positive"><i class="fas fa-arrow-down"></i> 0.3s mais rápido</div>
                    </div>
                </div>

                <div class="charts-grid">
                    <div class="glass" style="padding: clamp(1rem, 2vw, 1.5rem);">
                        <h3 style="margin-bottom: clamp(1rem, 2vw, 1.5rem); font-size: clamp(0.9rem, 1.8vw, 1rem);">Volume de Requisições (7 dias)</h3>
                        <div class="chart-container">
                            <canvas id="requestsChart"></canvas>
                        </div>
                    </div>
                    <div class="glass" style="padding: clamp(1rem, 2vw, 1.5rem);">
                        <h3 style="margin-bottom: clamp(1rem, 2vw, 1.5rem); font-size: clamp(0.9rem, 1.8vw, 1rem);">Distribuição por Setor</h3>
                        <div class="chart-container">
                            <canvas id="sectorChart"></canvas>
                        </div>
                    </div>
                    <div class="glass" style="padding: clamp(1rem, 2vw, 1.5rem);">
                        <h3 style="margin-bottom: clamp(1rem, 2vw, 1.5rem); font-size: clamp(0.9rem, 1.8vw, 1rem);">Tempo de Resposta (ms)</h3>
                        <div class="chart-container">
                            <canvas id="responseTimeChart"></canvas>
                        </div>
                    </div>
                    <div class="glass" style="padding: clamp(1rem, 2vw, 1.5rem);">
                        <h3 style="margin-bottom: clamp(1rem, 2vw, 1.5rem); font-size: clamp(0.9rem, 1.8vw, 1rem);">Modelos LLM Utilizados</h3>
                        <div class="chart-container">
                            <canvas id="llmChart"></canvas>
                        </div>
                    </div>
                    <div class="glass" style="padding: clamp(1rem, 2vw, 1.5rem);">
                        <h3 style="margin-bottom: clamp(1rem, 2vw, 1.5rem); font-size: clamp(0.9rem, 1.8vw, 1rem);">Economia Acumulada (R$)</h3>
                        <div class="chart-container">
                            <canvas id="economyChart"></canvas>
                        </div>
                    </div>
                    <div class="glass" style="padding: clamp(1rem, 2vw, 1.5rem);">
                        <h3 style="margin-bottom: clamp(1rem, 2vw, 1.5rem); font-size: clamp(0.9rem, 1.8vw, 1rem);">Status dos Agentes</h3>
                        <div class="chart-container">
                            <canvas id="statusChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chat Content -->
            <div id="view-chat" style="display: none;">
                <header class="top-bar">
                    <div>
                        <h1>Centro de Mensagens</h1>
                        <p>Interaja com seus agentes especialistas.</p>
                    </div>
                    <button class="btn btn-primary" onclick="TicoApp.newChat()"><i class="fas fa-plus"></i> <span>Nova Conversa</span></button>
                </header>
                <div class="chat-container glass">
                    <div class="chat-sidebar">
                        <div style="padding: clamp(0.5rem, 1.5vw, 1rem); border-bottom: 1px solid var(--border-light); width: 100%;">
                            <div class="input-group" style="margin-bottom: 0;">
                                <input type="text" class="input-field" placeholder="Buscar..." style="padding: clamp(0.4rem, 1vw, 0.5rem) clamp(0.6rem, 1.5vw, 1rem); font-size: clamp(0.75rem, 1.5vw, 0.85rem);">
                            </div>
                        </div>
                        <div class="chat-list">
                            <div class="chat-item active" onclick="TicoApp.selectChat('supervisor')">
                                <i class="fas fa-shield-halved"></i>
                                <div><p style="font-weight: 600;">Supervisor</p><p style="color: var(--text-tertiary);">Roteamento</p></div>
                            </div>
                            <div id="agentsChatList"></div>
                        </div>
                    </div>
                    <div class="chat-main">
                        <div class="chat-header">
                            <div style="display: flex; align-items: center; gap: clamp(0.5rem, 1.5vw, 1rem);">
                                <div id="activeAgentIcon"><i class="fas fa-shield-halved"></i></div>
                                <div>
                                    <p style="font-weight: 700;" id="activeAgentName">Agente Supervisor</p>
                                    <p style="color: var(--success);" id="activeAgentStatus">Online • Roteamento Ativo</p>
                                </div>
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <span class="status-badge" style="background: var(--bg-tertiary); color: var(--text-secondary);" id="activeAgentTag">SUPERVISOR</span>
                            </div>
                        </div>
                        <div class="chat-messages" id="mainChatMessages">
                            <div class="message bot">
                                <span class="supervisor-tag">SUPERVISOR</span> Olá! Como posso ajudar você hoje?
                                <span class="message-info">Agora</span>
                            </div>
                        </div>
                        <div class="chat-input-area">
                            <form id="mainChatForm">
                                <div class="chat-input-wrapper">
                                    <button type="button" class="btn" style="padding: clamp(0.3rem, 1vw, 0.5rem); background: transparent; color: var(--text-tertiary);" onclick="document.getElementById('chatFile').click()"><i class="fas fa-paperclip"></i></button>
                                    <input type="file" id="chatFile" style="display: none;" onchange="TicoApp.handleChatFileUpload(this)">
                                    <input type="text" id="mainChatInput" placeholder="Digite sua mensagem...">
                                    <button type="button" id="audioBtn" class="btn" style="padding: clamp(0.3rem, 1vw, 0.5rem); background: transparent; color: var(--text-tertiary);" onclick="TicoApp.toggleAudioRecording()"><i class="fas fa-microphone"></i></button>
                                    <button type="submit" class="btn btn-primary" style="padding: clamp(0.3rem, 1vw, 0.5rem) clamp(0.8rem, 1.5vw, 1.2rem);"><i class="fas fa-paper-plane"></i></button>
                                </div>
                            </form>
                            <div style="display: flex; gap: clamp(0.5rem, 1.5vw, 1rem); margin-top: 0.75rem; flex-wrap: wrap;">
                                <select id="agentSelector" class="input-field" style="padding: clamp(0.3rem, 0.8vw, 0.4rem) clamp(0.6rem, 1.2vw, 0.75rem); font-size: clamp(0.7rem, 1.3vw, 0.8rem); width: auto;" onchange="TicoApp.selectChat(this.value)">
                                    <option value="supervisor">Falar com Supervisor</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Meus Agentes View -->
            <div id="view-agents" class="agents-view" style="display: none;">
                <header class="top-bar">
                    <div><h1>Meus Agentes</h1><p>Gerencie todos os seus agentes inteligentes.</p></div>
                    <button class="btn btn-primary" onclick="TicoApp.openAgentModal()"><i class="fas fa-plus"></i> <span>Criar Agente</span></button>
                </header>
                <div class="glass" style="padding: clamp(1rem, 2vw, 1.5rem);">
                    <div class="table-responsive">
                        <table>
                            <thead><tr><th>Agente</th><th>Setor</th><th>Status</th><th>Desempenho</th><th>Requisições</th><th>Última Atividade</th><th>Ações</th></tr></thead>
                            <tbody class="agents-table-body"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Gestão de Usuários View -->
            <div id="view-users" class="users-view" style="display: none;">
                <header class="top-bar">
                    <div><h1>Gestão de Usuários</h1><p>Controle acessos, departamentos e permissões.</p></div>
                    <button class="btn btn-primary" onclick="TicoApp.openUserModal()"><i class="fas fa-user-plus"></i> <span>Novo Usuário</span></button>
                </header>
                <div class="glass" style="padding: clamp(1rem, 2vw, 1.5rem);">
                    <div class="table-responsive">
                        <table>
                            <thead><tr><th>Usuário</th><th>Departamento</th><th>Nível de Acesso</th><th>Agentes Permitidos</th><th>Status</th><th>Ações</th></tr></thead>
                            <tbody id="usersTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Logs do Sistema View -->
            <div id="view-logs" class="logs-view" style="display: none;">
                <header class="top-bar">
                    <div><h1>Logs do Sistema</h1><p>Histórico completo de auditoria e ações.</p></div>
                    <button class="btn btn-outline" onclick="TicoApp.clearLogs()"><i class="fas fa-trash"></i> <span>Limpar</span></button>
                </header>
                <div class="glass" style="padding: clamp(1rem, 2vw, 1.5rem); max-height: 600px; overflow-y: auto;" id="systemLogsContainer"></div>
            </div>

            <!-- Auditoria de Chats View -->
            <div id="view-chat-logs" class="chat-logs-view" style="display: none;">
                <header class="top-bar">
                    <div><h1>Auditoria de Chats</h1><p>Histórico de conversas entre usuários e agentes.</p></div>
                </header>
                <div class="glass" style="padding: clamp(1rem, 2vw, 1.5rem); max-height: 600px; overflow-y: auto;" id="chatLogsContainer"></div>
            </div>

            <!-- Settings Content (Enhanced) -->
            <div id="view-settings" class="settings-view" style="display: none;">
                <header class="top-bar">
                    <div><h1>Configurações</h1><p>Gerencie sua conta, segurança e preferências do sistema.</p></div>
                </header>
                
                <div class="settings-layout">
                    <div class="settings-nav">
                        <div class="settings-nav-btn active" data-section="profile"><i class="fas fa-user"></i> <span>Perfil</span></div>
                        <div class="settings-nav-btn" data-section="security"><i class="fas fa-shield-alt"></i> <span>Segurança</span></div>
                        <div class="settings-nav-btn" data-section="appearance"><i class="fas fa-paint-brush"></i> <span>Aparência</span></div>
                        <div class="settings-nav-btn" data-section="notifications"><i class="fas fa-bell"></i> <span>Notificações</span></div>
                        <div class="settings-nav-btn" data-section="system"><i class="fas fa-server"></i> <span>Sistema</span></div>
                    </div>
                    
                    <div class="settings-content">
                        <!-- Profile Section -->
                        <div id="settings-profile" class="settings-section active">
                            <div class="settings-card glass">
                                <h2><i class="fas fa-user-circle"></i> Informações do Perfil</h2>
                                <div style="display: flex; align-items: center; gap: clamp(1rem, 3vw, 2rem); margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid var(--border-light); flex-wrap: wrap;">
                                    <div style="position: relative;">
                                        <img src="https://ui-avatars.com/api/?name=User&background=random" id="settingsAvatar" style="width: clamp(80px, 20vw, 120px); height: clamp(80px, 20vw, 120px); border-radius: 50%; border: 4px solid var(--text-primary); object-fit: cover;">
                                        <label for="avatarInput" style="position: absolute; bottom: 5px; right: 5px; background: var(--text-primary); color: var(--bg-primary); width: clamp(30px, 7vw, 35px); height: clamp(30px, 7vw, 35px); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.3); font-size: clamp(0.8rem, 1.5vw, 1rem);"><i class="fas fa-camera"></i></label>
                                        <input type="file" id="avatarInput" style="display: none;" accept="image/*">
                                    </div>
                                    <div>
                                        <h3 class="user-name-display" style="font-size: clamp(1.2rem, 3vw, 1.5rem);">Usuário</h3>
                                        <p style="color: var(--text-tertiary); font-size: clamp(0.8rem, 1.5vw, 0.9rem);" id="userRoleDisplay">Administrador do Sistema</p>
                                        <p style="font-size: clamp(0.7rem, 1.3vw, 0.8rem); margin-top: 0.5rem; color: var(--text-secondary);"><i class="fas fa-building"></i> <span id="userDeptDisplay">TI</span></p>
                                    </div>
                                </div>
                                <form id="settingsForm">
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(clamp(150px, 100%, 300px), 1fr)); gap: clamp(1rem, 2vw, 1.5rem);">
                                        <div class="input-group"><label>Nome de Exibição</label><input type="text" class="input-field" id="settingsName" required></div>
                                        <div class="input-group"><label>E-mail Corporativo</label><input type="email" class="input-field" id="settingsEmail" disabled></div>
                                    </div>
                                    <div class="input-group"><label>Bio / Descrição Curta</label><textarea class="input-field" id="settingsBio" rows="3" placeholder="Conte um pouco sobre você..."></textarea></div>
                                    <button type="submit" class="btn btn-primary">Salvar Alterações</button>
                                </form>
                            </div>
                        </div>

                        <!-- Security Section -->
                        <div id="settings-security" class="settings-section">
                            <div class="settings-card glass">
                                <h2><i class="fas fa-lock"></i> Segurança da Conta</h2>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Autenticação em Duas Etapas (2FA)</h4>
                                        <p>Adicione uma camada extra de segurança à sua conta.</p>
                                    </div>
                                    <label class="toggle-switch"><input type="checkbox" id="setting2FA"><span class="slider"></span></label>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Alertas de Login</h4>
                                        <p>Receba notificações sobre novos acessos em sua conta.</p>
                                    </div>
                                    <label class="toggle-switch"><input type="checkbox" checked><span class="slider"></span></label>
                                </div>
                                <div style="margin-top: 2rem;">
                                    <h3 style="font-size: clamp(0.9rem, 1.8vw, 1rem); margin-bottom: 1rem;">Alterar Senha</h3>
                                    <div class="input-group"><label>Senha Atual</label><input type="password" class="input-field" placeholder="••••••••"></div>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(clamp(150px, 100%, 250px), 1fr)); gap: clamp(1rem, 2vw, 1.5rem);">
                                        <div class="input-group"><label>Nova Senha</label><input type="password" class="input-field" placeholder="••••••••"></div>
                                        <div class="input-group"><label>Confirmar Nova Senha</label><input type="password" class="input-field" placeholder="••••••••"></div>
                                    </div>
                                    <button class="btn btn-outline">Atualizar Senha</button>
                                </div>
                            </div>
                        </div>

                        <!-- Appearance Section -->
                        <div id="settings-appearance" class="settings-section">
                            <div class="settings-card glass">
                                <h2><i class="fas fa-palette"></i> Personalização</h2>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Modo Escuro</h4>
                                        <p>Alternar entre tema claro e escuro.</p>
                                    </div>
                                    <label class="toggle-switch"><input type="checkbox" id="themeToggleCheck" onchange="TicoApp.toggleTheme()"><span class="slider"></span></label>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Animações da Interface</h4>
                                        <p>Habilitar efeitos visuais e transições suaves.</p>
                                    </div>
                                    <label class="toggle-switch"><input type="checkbox" checked><span class="slider"></span></label>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Densidade do Layout</h4>
                                        <p>Escolha entre um visual mais espaçado ou compacto.</p>
                                    </div>
                                    <select class="input-field" style="width: auto; padding: clamp(0.3rem, 0.8vw, 0.4rem) clamp(0.6rem, 1.2vw, 1rem);">
                                        <option>Padrão</option>
                                        <option>Compacto</option>
                                        <option>Confortável</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Notifications Section -->
                        <div id="settings-notifications" class="settings-section">
                            <div class="settings-card glass">
                                <h2><i class="fas fa-bell"></i> Preferências de Notificação</h2>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Notificações Push</h4>
                                        <p>Receber alertas no navegador sobre novas mensagens.</p>
                                    </div>
                                    <label class="toggle-switch"><input type="checkbox" checked><span class="slider"></span></label>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Resumo Diário por E-mail</h4>
                                        <p>Receba um relatório matinal com as atividades dos agentes.</p>
                                    </div>
                                    <label class="toggle-switch"><input type="checkbox"><span class="slider"></span></label>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Sons de Notificação</h4>
                                        <p>Reproduzir som ao receber uma resposta de agente.</p>
                                    </div>
                                    <label class="toggle-switch"><input type="checkbox" checked><span class="slider"></span></label>
                                </div>
                            </div>
                        </div>

                        <!-- System Section -->
                        <div id="settings-system" class="settings-section">
                            <div class="settings-card glass">
                                <h2><i class="fas fa-server"></i> Configurações do Sistema</h2>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Modo de Depuração (Debug)</h4>
                                        <p>Exibir logs técnicos detalhados no console.</p>
                                    </div>
                                    <label class="toggle-switch"><input type="checkbox"><span class="slider"></span></label>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <h4>Auto-limpeza de Logs</h4>
                                        <p>Remover logs do sistema com mais de 30 dias.</p>
                                    </div>
                                    <label class="toggle-switch"><input type="checkbox" checked><span class="slider"></span></label>
                                </div>
                                <div style="margin-top: 2rem; padding-top: 2rem; border-top: 1px solid var(--border-light);">
                                    <h3 style="color: var(--error); font-size: clamp(0.9rem, 1.8vw, 1rem); margin-bottom: 1rem;">Zona de Perigo</h3>
                                    <p style="font-size: clamp(0.75rem, 1.3vw, 0.85rem); color: var(--text-tertiary); margin-bottom: 1.5rem;">Ações abaixo são permanentes e não podem ser desfeitas.</p>
                                    <div style="display: flex; gap: clamp(0.5rem, 1.5vw, 1rem); flex-wrap: wrap;">
                                        <button class="btn btn-outline" style="color: var(--error); border-color: var(--error); font-size: clamp(0.7rem, 1.3vw, 0.85rem);" onclick="TicoApp.resetAllData()">Resetar Dados</button>
                                        <button class="btn btn-danger" style="font-size: clamp(0.7rem, 1.3vw, 0.85rem);">Excluir Conta</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <footer class="footer" style="margin-top: clamp(2rem, 4vw, 3rem); text-align: center; padding: clamp(1.5rem, 3vw, 2rem); border-top: 1px solid var(--border-light); color: var(--text-tertiary); font-size: clamp(0.7rem, 1.3vw, 0.8rem);">
                <p>&copy; 2024 TICO IA. Todos os direitos reservados. Inteligência sob Governança.</p>
            </footer>
        </main>
    </div>

    <!-- User Modal -->
    <div class="modal-overlay" id="userModal">
        <div class="modal-content glass">
            <h2 id="modalTitle" style="margin-bottom: clamp(1rem, 2vw, 1.5rem); font-size: clamp(1.1rem, 2vw, 1.3rem);">Novo Usuário</h2>
            <form id="userForm">
                <input type="hidden" id="userId">
                <div class="input-group"><label>Nome Completo</label><input type="text" class="input-field" id="userName" required></div>
                <div class="input-group">
                    <label>Departamento</label>
                    <select class="input-field" id="userDept" required>
                        <option value="RH">RH</option><option value="TI">TI</option><option value="DP">DP</option><option value="ENGENHARIA">ENGENHARIA</option>
                        <option value="FINANCEIRO">FINANCEIRO</option><option value="SUPRIMENTOS">SUPRIMENTOS</option><option value="SMS">SMS</option><option value="ADMINISTRATIVO">ADMINISTRATIVO</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Nível de Acesso</label>
                    <select class="input-field" id="userRole" required>
                        <option value="Usuário">Usuário</option><option value="Manager">Manager</option><option value="Admin">Admin</option>
                    </select>
                </div>
                <div class="input-group"><label>Agentes Permitidos</label><input type="text" class="input-field" id="userAgents" placeholder="Ex: Recrutador, Faturamento"></div>
                <div style="display: flex; gap: clamp(0.75rem, 1.5vw, 1rem); margin-top: clamp(1.5rem, 2vw, 2rem); flex-wrap: wrap;">
                    <button type="button" class="btn btn-outline" style="flex: 1; min-width: 100px; font-size: clamp(0.75rem, 1.3vw, 0.85rem);" onclick="TicoApp.closeUserModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary" style="flex: 1; min-width: 100px; font-size: clamp(0.75rem, 1.3vw, 0.85rem);">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Agent Modal -->
    <div class="modal-overlay" id="agentModal">
        <div class="modal-content glass">
            <h2 style="margin-bottom: clamp(1rem, 2vw, 1.5rem); font-size: clamp(1.1rem, 2vw, 1.3rem);">Configurar Novo Agente</h2>
            <form id="agentForm">
                <div class="input-group"><label>Nome do Agente</label><input type="text" class="input-field" id="agentName" placeholder="Ex: Analista Fiscal IA" required></div>
                <div class="input-group">
                    <label>Setor</label>
                    <select class="input-field" id="agentSector" required>
                        <option value="RH">RH</option><option value="TI">TI</option><option value="DP">DP</option><option value="ENGENHARIA">ENGENHARIA</option>
                        <option value="FINANCEIRO">FINANCEIRO</option><option value="SUPRIMENTOS">SUPRIMENTOS</option><option value="SMS">SMS</option><option value="ADMINISTRATIVO">ADMINISTRATIVO</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Modelo LLM</label>
                    <select class="input-field" id="agentLlm" required>
                        <option value="gpt-4">GPT-4 Turbo</option><option value="gpt-3.5">GPT-3.5</option><option value="claude-3">Claude 3 Opus</option><option value="gemini-pro">Gemini Pro</option>
                    </select>
                </div>
                <div class="input-group"><label>API Key do LLM</label><input type="password" class="input-field" id="agentApiKey" placeholder="sk-..." required></div>
                <div style="display: flex; gap: clamp(0.75rem, 1.5vw, 1rem); margin-top: clamp(1.5rem, 2vw, 2rem); flex-wrap: wrap;">
                    <button type="button" class="btn btn-outline" style="flex: 1; min-width: 100px; font-size: clamp(0.75rem, 1.3vw, 0.85rem);" onclick="TicoApp.closeAgentModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary" style="flex: 1; min-width: 100px; font-size: clamp(0.75rem, 1.3vw, 0.85rem);">Criar Agente</button>
                </div>
            </form>
        </div>
    </div>

    <div id="notificationContainer"></div>

    <script>
        const TicoApp = {
            state: {
                user: null,
                tempUser: null,
                theme: localStorage.getItem('tico_theme') || 'dark',
                activeChat: 'supervisor',
                isRecording: false,
                agents: JSON.parse(localStorage.getItem('tico_agents')) || [
                    { id: 'rh', name: 'Recrutador IA', sector: 'RH', status: 'online', performance: 95, requests: '1.2k', lastSeen: '2 min', keywords: ['contratar', 'vaga', 'rh', 'recrutamento', 'talento', 'demissão', 'folha'], llm: 'GPT-4', icon: 'fa-user-tie' },
                    { id: 'eng', name: 'Analista de Projetos', sector: 'ENGENHARIA', status: 'online', performance: 88, requests: '850', lastSeen: 'Agora', keywords: ['projeto', 'obra', 'engenharia', 'cálculo', 'planta', 'estrutura'], llm: 'GPT-4', icon: 'fa-drafting-compass' },
                    { id: 'sup', name: 'Gestor de Estoque', sector: 'SUPRIMENTOS', status: 'online', performance: 92, requests: '2.4k', lastSeen: '5 min', keywords: ['estoque', 'compra', 'suprimentos', 'fornecedor', 'entrega', 'material'], llm: 'GPT-3.5', icon: 'fa-boxes-stacked' },
                    { id: 'adm', name: 'Faturamento Auto', sector: 'ADMINISTRATIVO', status: 'online', performance: 91, requests: '1.8k', lastSeen: '3 min', keywords: ['faturamento', 'nota', 'administrativo', 'boleto', 'pagamento', 'adm'], llm: 'Claude 3', icon: 'fa-file-invoice-dollar' }
                ],
                users: JSON.parse(localStorage.getItem('tico_users')) || [
                    { id: 1, name: 'Ana Silva', dept: 'RH', role: 'Manager', agents: 'Recrutador, Triagem', status: 'Ativo' },
                    { id: 2, name: 'Carlos Souza', dept: 'TI', role: 'Admin', agents: 'Todos', status: 'Ativo' }
                ],
                systemLogs: JSON.parse(localStorage.getItem('tico_system_logs')) || [],
                chatLogs: JSON.parse(localStorage.getItem('tico_chat_logs')) || [],
                chartData: { 
                    line: [400, 600, 800, 500, 900, 1200, 1000], 
                    pie: [35, 25, 25, 15],
                    responseTime: [1500, 1200, 1800, 900, 1100, 1300, 1000],
                    llmModels: [45, 30, 15, 10],
                    economy: [5000, 12000, 20000, 30000, 42000],
                    agentStatus: [8, 3, 1]
                },
                validations: { cpf: false, password: false },
                charts: {}
            },

            init() {
                try {
                    this.applyTheme();
                    const savedUser = localStorage.getItem('tico_user');
                    if (savedUser) this.state.user = JSON.parse(savedUser);
                    this.cacheDOM();
                    this.bindEvents();
                    this.checkAuth();
                    this.hideLoading();
                    this.handleResize();
                    window.addEventListener('resize', () => this.handleResize());
                    window.addEventListener('orientationchange', () => this.handleResize());
                } catch (e) { console.error(e); this.hideLoading(); }
            },

            handleResize() {
                const isMobile = window.innerWidth <= 1024;
                if (isMobile && this.dom.sidebar && this.dom.sidebar.classList.contains('open')) {
                    document.body.style.overflow = 'hidden';
                } else {
                    document.body.style.overflow = 'auto';
                }
                
                // Redesenha os gráficos ao redimensionar
                setTimeout(() => {
                    if (this.state.user) this.initCharts();
                }, 100);
            },

            applyTheme() {
                document.documentElement.setAttribute('data-theme', this.state.theme);
                const icon = document.querySelector('#themeToggle i');
                if (icon) icon.className = this.state.theme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
                const check = document.getElementById('themeToggleCheck');
                if (check) check.checked = this.state.theme === 'dark';
            },

            toggleTheme() {
                this.state.theme = this.state.theme === 'dark' ? 'light' : 'dark';
                localStorage.setItem('tico_theme', this.state.theme);
                this.applyTheme();
                if (this.state.user) this.initCharts();
            },

            hideLoading() {
                const loading = document.getElementById('loadingScreen');
                if (loading) {
                    loading.style.opacity = '0';
                    setTimeout(() => loading.style.display = 'none', 500);
                }
            },

            cacheDOM() {
                this.dom = {
                    loginView: document.getElementById('loginView'),
                    registerView: document.getElementById('registerView'),
                    verifyView: document.getElementById('verifyView'),
                    resetView: document.getElementById('resetView'),
                    dashboardView: document.getElementById('dashboardView'),
                    sidebar: document.getElementById('sidebar'),
                    loginForm: document.getElementById('loginForm'),
                    registerForm: document.getElementById('registerForm'),
                    resetForm: document.getElementById('resetForm'),
                    settingsForm: document.getElementById('settingsForm'),
                    logoutBtn: document.getElementById('logoutBtn'),
                    toRegister: document.getElementById('toRegister'),
                    toReset: document.getElementById('toReset'),
                    toLoginFromReg: document.getElementById('toLoginFromReg'),
                    toLoginFromReset: document.getElementById('toLoginFromReset'),
                    regSubmit: document.getElementById('regSubmit'),
                    regCpf: document.getElementById('regCpf'),
                    verifyBtn: document.getElementById('verifyBtn'),
                    codeInputs: Array.from(document.querySelectorAll('.code-input')),
                    mainChatMessages: document.getElementById('mainChatMessages'),
                    mainChatInput: document.getElementById('mainChatInput'),
                    mainChatForm: document.getElementById('mainChatForm'),
                    agentSelector: document.getElementById('agentSelector'),
                    activeAgentName: document.getElementById('activeAgentName'),
                    activeAgentStatus: document.getElementById('activeAgentStatus'),
                    activeAgentIcon: document.getElementById('activeAgentIcon'),
                    activeAgentTag: document.getElementById('activeAgentTag'),
                    audioBtn: document.getElementById('audioBtn'),
                    avatarInput: document.getElementById('avatarInput'),
                    exportCsvBtn: document.getElementById('exportCsvBtn'),
                    userForm: document.getElementById('userForm'),
                    agentForm: document.getElementById('agentForm')
                };
            },

            bindEvents() {
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', (e) => {
                        const view = e.currentTarget.getAttribute('data-view');
                        this.switchView(view);
                    });
                });

                document.querySelectorAll('.settings-nav-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const section = e.currentTarget.getAttribute('data-section');
                        this.switchSettingsSection(section);
                    });
                });

                this.dom.toRegister?.addEventListener('click', (e) => { e.preventDefault(); this.showRegister(); });
                this.dom.toReset?.addEventListener('click', (e) => { e.preventDefault(); this.showReset(); });
                this.dom.toLoginFromReg?.addEventListener('click', (e) => { e.preventDefault(); this.showAuth(); });
                this.dom.toLoginFromReset?.addEventListener('click', (e) => { e.preventDefault(); this.showAuth(); });

                this.dom.loginForm?.addEventListener('submit', (e) => { e.preventDefault(); this.handleLogin(); });
                this.dom.registerForm?.addEventListener('submit', (e) => { e.preventDefault(); this.handleRegister(); });
                this.dom.resetForm?.addEventListener('submit', (e) => { e.preventDefault(); this.handleReset(); });
                this.dom.logoutBtn?.addEventListener('click', () => this.handleLogout());
                this.dom.settingsForm?.addEventListener('submit', (e) => { e.preventDefault(); this.handleSaveSettings(); });
                this.dom.avatarInput?.addEventListener('change', (e) => this.handleAvatarUpload(e));
                this.dom.mainChatForm?.addEventListener('submit', (e) => { e.preventDefault(); this.handleMainChatMessage(); });
                this.dom.exportCsvBtn?.addEventListener('click', () => this.exportToCsv());
                this.dom.userForm?.addEventListener('submit', (e) => { e.preventDefault(); this.handleUserSubmit(); });
                this.dom.agentForm?.addEventListener('submit', (e) => { e.preventDefault(); this.handleAgentSubmit(); });
                this.dom.verifyBtn?.addEventListener('click', () => this.handleVerifyCode());

                this.dom.regCpf?.addEventListener('input', (e) => this.handleCpfInput(e));
                document.getElementById('regPassword')?.addEventListener('input', (e) => this.validatePassword(e.target.value));
                
                this.dom.codeInputs.forEach((input, idx) => {
                    input.addEventListener('input', (e) => {
                        if (e.target.value && idx < 5) this.dom.codeInputs[idx + 1].focus();
                    });
                    input.addEventListener('keydown', (e) => {
                        if (e.key === 'Backspace' && !e.target.value && idx > 0) this.dom.codeInputs[idx - 1].focus();
                    });
                });

                document.querySelectorAll('.toggle-password').forEach(icon => {
                    icon.addEventListener('click', (e) => {
                        const input = document.getElementById(e.target.getAttribute('data-target'));
                        if (input) { input.type = input.type === 'password' ? 'text' : 'password'; e.target.classList.toggle('fa-eye'); e.target.classList.toggle('fa-eye-slash'); }
                    });
                });
            },

            switchSettingsSection(sectionId) {
                document.querySelectorAll('.settings-nav-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.getAttribute('data-section') === sectionId);
                });
                document.querySelectorAll('.settings-section').forEach(sec => {
                    sec.classList.toggle('active', sec.id === `settings-${sectionId}`);
                });
            },

            handleCpfInput(e) {
                let value = e.target.value.replace(/\D/g, "");
                if (value.length > 11) value = value.slice(0, 11);
                value = value.replace(/(\d{3})(\d)/, "$1.$2").replace(/(\d{3})(\d)/, "$1.$2").replace(/(\d{3})(\d{1,2})$/, "$1-$2");
                e.target.value = value;
                const rawCpf = value.replace(/\D/g, "");
                if (rawCpf.length === 11) {
                    const isValid = this.validateCpf(rawCpf);
                    this.state.validations.cpf = isValid;
                    e.target.classList.toggle('invalid', !isValid);
                } else this.state.validations.cpf = false;
                this.updateRegSubmit();
            },

            validateCpf(cpf) {
                if (/^(\d)\1+$/.test(cpf)) return false;
                let sum = 0, rev;
                for (let i = 0; i < 9; i++) sum += parseInt(cpf.charAt(i)) * (10 - i);
                rev = 11 - (sum % 11);
                if (rev === 10 || rev === 11) rev = 0;
                if (rev !== parseInt(cpf.charAt(9))) return false;
                sum = 0;
                for (let i = 0; i < 10; i++) sum += parseInt(cpf.charAt(i)) * (11 - i);
                rev = 11 - (sum % 11);
                if (rev === 10 || rev === 11) rev = 0;
                if (rev !== parseInt(cpf.charAt(10))) return false;
                return true;
            },

            validatePassword(password) {
                const reqs = { uppercase: /[A-Z]/.test(password), lowercase: /[a-z]/.test(password), number: /[0-9]/.test(password), special: /[!@#$%^&*(),.?":{}|<>]/.test(password) };
                let allMet = true;
                Object.entries(reqs).forEach(([req, met]) => {
                    const el = document.querySelector(`.requirement[data-req="${req}"]`);
                    if (el) { el.classList.toggle('met', met); el.querySelector('i').className = met ? 'fas fa-check-circle' : 'fas fa-circle'; }
                    if (!met) allMet = false;
                });
                this.state.validations.password = allMet;
                this.updateRegSubmit();
            },

            updateRegSubmit() { 
                if (this.dom.regSubmit) {
                    this.dom.regSubmit.disabled = !(this.state.validations.cpf && this.state.validations.password); 
                }
            },

            switchView(view) {
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                const activeLink = document.querySelector(`.nav-link[data-view="${view}"]`);
                if (activeLink) activeLink.classList.add('active');
                
                ['main', 'chat', 'agents', 'users', 'logs', 'chat-logs', 'settings'].forEach(v => {
                    const el = document.getElementById(`view-${v}`);
                    if (el) el.style.display = v === view ? 'block' : 'none';
                });
                
                if (view === 'main') this.initCharts();
                if (view === 'users') this.renderUsers();
                if (view === 'logs') this.renderSystemLogs();
                if (view === 'chat-logs') this.renderChatLogs();
                if (view === 'agents' || view === 'main') this.renderAgents();
                if (view === 'chat') this.renderAgentsChatList();
            },

            selectChat(id) {
                this.state.activeChat = id;
                this.dom.agentSelector.value = id;
                
                document.querySelectorAll('.chat-item').forEach(item => item.classList.remove('active'));
                const activeItem = document.querySelector(`.chat-item[onclick*="'${id}'"]`);
                if (activeItem) activeItem.classList.add('active');

                const agent = id === 'supervisor' ? 
                    { name: 'Agente Supervisor', status: 'Online • Roteamento Ativo', icon: 'fa-shield-halved', tag: 'SUPERVISOR' } : 
                    { ...this.state.agents.find(a => a.id === id), tag: 'ESPECIALISTA' };
                
                this.dom.activeAgentName.textContent = agent.name;
                this.dom.activeAgentStatus.textContent = agent.status;
                this.dom.activeAgentIcon.innerHTML = `<i class="fas ${agent.icon || 'fa-robot'}"></i>`;
                this.dom.activeAgentTag.textContent = agent.tag;
                this.dom.mainChatMessages.innerHTML = `<div class="message bot">${id === 'supervisor' ? '<span class="supervisor-tag">SUPERVISOR</span>' : ''} Olá! Como posso ajudar você? <span class="message-info">Agora</span></div>`;
            },

            newChat() {
                this.selectChat(this.state.activeChat);
                this.notify('info', 'Nova Conversa', 'O histórico do chat foi reiniciado.');
                this.addLog('Nova Conversa', `Histórico de chat com ${this.state.activeChat} reiniciado.`);
            },

            toggleAudioRecording() {
                this.state.isRecording = !this.state.isRecording;
                this.dom.audioBtn.classList.toggle('recording', this.state.isRecording);
                if (this.state.isRecording) {
                    this.notify('info', 'Gravando Áudio', 'Fale agora...');
                } else {
                    this.addMainMessage('user', '<i class="fas fa-microphone"></i> Áudio enviado (0:05)');
                    this.addChatLog(this.state.activeChat, 'Áudio enviado');
                    setTimeout(() => this.addMainMessage('bot', 'Recebi seu áudio. Estou transcrevendo e analisando o conteúdo...'), 1000);
                }
            },

            handleMainChatMessage() {
                const text = this.dom.mainChatInput.value.trim();
                if (!text) return;
                this.addMainMessage('user', text);
                this.addChatLog(this.state.activeChat, text);
                this.dom.mainChatInput.value = '';
                
                if (this.state.activeChat === 'supervisor') {
                    setTimeout(() => {
                        const targetAgent = this.routeMessage(text);
                        if (targetAgent) {
                            this.addMainMessage('bot', `<span class="supervisor-tag">SUPERVISOR</span> Identifiquei que sua solicitação é sobre <strong>${targetAgent.sector}</strong>. Vou encaminhar você para o <strong>${targetAgent.name}</strong>.`);
                            setTimeout(() => this.selectChat(targetAgent.id), 2000);
                        } else this.addMainMessage('bot', `<span class="supervisor-tag">SUPERVISOR</span> Não consegui identificar um setor específico. Pode detalhar melhor?`);
                    }, 1000);
                } else {
                    setTimeout(() => this.addMainMessage('bot', `Entendido. Como especialista de ${this.state.agents.find(a => a.id === this.state.activeChat).sector}, estou processando sua solicitação.`), 1000);
                }
            },

            routeMessage(text) {
                const lower = text.toLowerCase();
                return this.state.agents.find(a => a.keywords.some(k => lower.includes(k)));
            },

            addMainMessage(type, text) {
                const div = document.createElement('div');
                div.className = `message ${type}`;
                div.innerHTML = `${text} <span class="message-info">Agora</span>`;
                this.dom.mainChatMessages.appendChild(div);
                this.dom.mainChatMessages.scrollTop = this.dom.mainChatMessages.scrollHeight;
            },

            handleChatFileUpload(input) {
                const file = input.files[0];
                if (file) {
                    this.addMainMessage('user', `<i class="fas fa-file"></i> Arquivo: ${file.name}`);
                    this.addChatLog(this.state.activeChat, `Arquivo: ${file.name}`);
                    setTimeout(() => this.addMainMessage('bot', `Recebi o arquivo <strong>${file.name}</strong>. Vou analisá-lo agora.`), 1000);
                }
            },

            checkAuth() {
                if (this.state.user) {
                    this.showDashboard();
                } else {
                    this.showAuth();
                }
            },

            showAuth() {
                document.getElementById('authViews').style.display = 'block';
                this.dom.loginView.style.display = 'flex';
                this.dom.registerView.style.display = 'none';
                this.dom.verifyView.style.display = 'none';
                this.dom.resetView.style.display = 'none';
                this.dom.dashboardView.style.display = 'none';
            },

            showRegister() {
                this.dom.loginView.style.display = 'none';
                this.dom.registerView.style.display = 'flex';
            },

            showReset() {
                this.dom.loginView.style.display = 'none';
                this.dom.resetView.style.display = 'flex';
            },

            showDashboard() {
                document.getElementById('authViews').style.display = 'none';
                this.dom.dashboardView.style.display = 'block';
                this.updateUserDisplays();
                this.switchView('main');
                this.addLog('Acesso ao Sistema', `Usuário ${this.state.user.name} realizou login.`);
            },

            updateUserDisplays() {
                const name = this.state.user?.name || 'Usuário';
                const email = this.state.user?.email || '';
                const dept = this.state.user?.dept || 'TI';
                const role = this.state.user?.role || 'Administrador';

                document.querySelectorAll('.user-name-display').forEach(el => el.textContent = name);
                document.querySelectorAll('.user-avatar-display').forEach(el => el.src = `https://ui-avatars.com/api/?name=${encodeURIComponent(name)}&background=random`);
                
                const companyDisplay = document.getElementById('companyDisplay');
                if (companyDisplay) companyDisplay.textContent = `Setor ${dept}`;

                const settingsName = document.getElementById('settingsName');
                const settingsEmail = document.getElementById('settingsEmail');
                const userRoleDisplay = document.getElementById('userRoleDisplay');
                const userDeptDisplay = document.getElementById('userDeptDisplay');

                if (settingsName) settingsName.value = name;
                if (settingsEmail) settingsEmail.value = email;
                if (userRoleDisplay) userRoleDisplay.textContent = role;
                if (userDeptDisplay) userDeptDisplay.textContent = dept;
            },

            handleLogin() {
                const email = document.getElementById('email').value;
                this.state.user = { name: email.split('@')[0], email: email, dept: 'TI', role: 'Admin' };
                localStorage.setItem('tico_user', JSON.stringify(this.state.user));
                this.notify('success', 'Bem-vindo!', 'Login realizado com sucesso.');
                this.showDashboard();
            },

            handleRegister() {
                this.state.tempUser = { name: document.getElementById('regName').value, email: document.getElementById('regEmail').value, dept: document.getElementById('regSector').value };
                this.dom.registerView.style.display = 'none';
                this.dom.verifyView.style.display = 'flex';
                this.notify('info', 'Código Enviado', 'Verifique seu e-mail corporativo.');
            },

            handleVerifyCode() {
                const code = this.dom.codeInputs.map(i => i.value).join('');
                if (code.length === 6) {
                    this.state.user = { ...this.state.tempUser, role: 'Usuário' };
                    localStorage.setItem('tico_user', JSON.stringify(this.state.user));
                    this.notify('success', 'Conta Verificada', 'Seu acesso foi liberado.');
                    this.showDashboard();
                } else this.notify('error', 'Código Inválido', 'Insira os 6 dígitos corretamente.');
            },

            handleReset() {
                this.notify('success', 'E-mail Enviado', 'As instruções foram enviadas para seu e-mail.');
                this.showAuth();
            },

            handleLogout() {
                this.state.user = null;
                localStorage.removeItem('tico_user');
                this.showAuth();
                this.notify('info', 'Sessão Encerrada', 'Você saiu do sistema com segurança.');
            },

            handleSaveSettings() {
                const newName = document.getElementById('settingsName').value;
                this.state.user.name = newName;
                localStorage.setItem('tico_user', JSON.stringify(this.state.user));
                this.updateUserDisplays();
                this.notify('success', 'Perfil Atualizado', 'Suas alterações foram salvas.');
                this.addLog('Alteração de Perfil', 'Dados do perfil foram atualizados.');
            },

            handleAvatarUpload(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        document.getElementById('settingsAvatar').src = event.target.result;
                        document.querySelectorAll('.user-avatar-display').forEach(el => el.src = event.target.result);
                        this.notify('success', 'Avatar Atualizado', 'Sua foto de perfil foi alterada.');
                    };
                    reader.readAsDataURL(file);
                }
            },

            renderAgents() {
                const bodies = document.querySelectorAll('.agents-table-body');
                bodies.forEach(body => {
                    body.innerHTML = this.state.agents.map(a => `
                        <tr>
                            <td><div style="display:flex;align-items:center;gap:0.5rem;"><i class="fas ${a.icon || 'fa-robot'}"></i> <strong>${a.name}</strong></div></td>
                            <td>${a.sector}</td>
                            <td><span class="status-badge status-${a.status}">${a.status}</span></td>
                            <td>
                                <div style="width:80px;height:6px;background:var(--bg-tertiary);border-radius:4px;overflow:hidden;">
                                    <div style="width:${a.performance}%;height:100%;background:var(--success);"></div>
                                </div>
                                <span style="font-size:0.65rem;">${a.performance}%</span>
                            </td>
                            <td>${a.requests}</td>
                            <td>${a.lastSeen}</td>
                            <td><button class="btn" style="padding:0.3rem 0.6rem; font-size: 0.7rem;" onclick="TicoApp.selectChat('${a.id}'); TicoApp.switchView('chat')"><i class="fas fa-comment"></i></button></td>
                        </tr>
                    `).join('');
                });
            },

            renderAgentsChatList() {
                const list = document.getElementById('agentsChatList');
                const selector = document.getElementById('agentSelector');
                
                list.innerHTML = this.state.agents.map(a => `
                    <div class="chat-item ${this.state.activeChat === a.id ? 'active' : ''}" onclick="TicoApp.selectChat('${a.id}')">
                        <i class="fas ${a.icon || 'fa-robot'}"></i>
                        <div><p style="font-weight: 600;">${a.name}</p><p style="color: var(--text-tertiary);">${a.sector}</p></div>
                    </div>
                `).join('');

                selector.innerHTML = '<option value="supervisor">Falar com Supervisor</option>' + 
                    this.state.agents.map(a => `<option value="${a.id}">${a.name} (${a.sector})</option>`).join('');
                selector.value = this.state.activeChat;
            },

            renderUsers() {
                const body = document.getElementById('usersTableBody');
                if (body) {
                    body.innerHTML = this.state.users.map(u => `
                        <tr>
                            <td><strong>${u.name}</strong></td>
                            <td>${u.dept}</td>
                            <td>${u.role}</td>
                            <td>${u.agents}</td>
                            <td><span class="status-badge status-online">${u.status}</span></td>
                            <td>
                                <button class="btn" style="padding:0.3rem 0.6rem; font-size: 0.7rem;" onclick="TicoApp.editUser(${u.id})"><i class="fas fa-edit"></i></button>
                                <button class="btn" style="padding:0.3rem 0.6rem; font-size: 0.7rem; color:var(--error);" onclick="TicoApp.deleteUser(${u.id})"><i class="fas fa-trash"></i></button>
                            </td>
                        </tr>
                    `).join('');
                }
            },

            openUserModal() {
                document.getElementById('modalTitle').textContent = 'Novo Usuário';
                document.getElementById('userForm').reset();
                document.getElementById('userId').value = '';
                document.getElementById('userModal').style.display = 'flex';
            },

            closeUserModal() { document.getElementById('userModal').style.display = 'none'; },

            handleUserSubmit() {
                const id = document.getElementById('userId').value;
                const user = {
                    id: id ? parseInt(id) : Date.now(),
                    name: document.getElementById('userName').value,
                    dept: document.getElementById('userDept').value,
                    role: document.getElementById('userRole').value,
                    agents: document.getElementById('userAgents').value || 'Nenhum',
                    status: 'Ativo'
                };
                if (id) {
                    const idx = this.state.users.findIndex(u => u.id === parseInt(id));
                    this.state.users[idx] = user;
                } else this.state.users.push(user);
                localStorage.setItem('tico_users', JSON.stringify(this.state.users));
                this.renderUsers();
                this.closeUserModal();
                this.notify('success', 'Sucesso', 'Usuário salvo com sucesso.');
                this.addLog('Gestão de Usuários', `Usuário ${user.name} foi ${id ? 'atualizado' : 'criado'}.`);
            },

            editUser(id) {
                const u = this.state.users.find(u => u.id === id);
                document.getElementById('modalTitle').textContent = 'Editar Usuário';
                document.getElementById('userId').value = u.id;
                document.getElementById('userName').value = u.name;
                document.getElementById('userDept').value = u.dept;
                document.getElementById('userRole').value = u.role;
                document.getElementById('userAgents').value = u.agents;
                document.getElementById('userModal').style.display = 'flex';
            },

            deleteUser(id) {
                if (confirm('Deseja realmente excluir este usuário?')) {
                    this.state.users = this.state.users.filter(u => u.id !== id);
                    localStorage.setItem('tico_users', JSON.stringify(this.state.users));
                    this.renderUsers();
                    this.notify('info', 'Usuário Removido', 'O registro foi excluído.');
                }
            },

            openAgentModal() { document.getElementById('agentModal').style.display = 'flex'; },
            closeAgentModal() { document.getElementById('agentModal').style.display = 'none'; },

            handleAgentSubmit() {
                const agent = {
                    id: 'agent-' + Date.now(),
                    name: document.getElementById('agentName').value,
                    sector: document.getElementById('agentSector').value,
                    llm: document.getElementById('agentLlm').value,
                    status: 'online',
                    performance: 100,
                    requests: '0',
                    lastSeen: 'Agora',
                    keywords: [document.getElementById('agentSector').value.toLowerCase()],
                    icon: 'fa-robot'
                };
                this.state.agents.push(agent);
                localStorage.setItem('tico_agents', JSON.stringify(this.state.agents));
                this.renderAgents();
                this.renderAgentsChatList();
                this.closeAgentModal();
                this.notify('success', 'Agente Criado', `${agent.name} está pronto para operar.`);
                this.addLog('Novo Agente', `Agente ${agent.name} foi configurado no setor ${agent.sector}.`);
            },

            addLog(action, details) {
                const log = { id: Date.now(), time: new Date().toLocaleString(), action, details };
                this.state.systemLogs.unshift(log);
                if (this.state.systemLogs.length > 100) this.state.systemLogs.pop();
                localStorage.setItem('tico_system_logs', JSON.stringify(this.state.systemLogs));
            },

            addChatLog(agentId, message) {
                const log = { id: Date.now(), time: new Date().toLocaleString(), agent: agentId, user: this.state.user.name, message };
                this.state.chatLogs.unshift(log);
                localStorage.setItem('tico_chat_logs', JSON.stringify(this.state.chatLogs));
            },

            renderSystemLogs() {
                const container = document.getElementById('systemLogsContainer');
                if (container) {
                    container.innerHTML = this.state.systemLogs.map(l => `
                        <div style="padding:clamp(0.5rem, 1.5vw, 0.75rem);border-bottom:1px solid var(--border-light);font-size:clamp(0.7rem, 1.3vw, 0.8rem);">
                            <span style="color:var(--text-tertiary);">${l.time}</span> | 
                            <strong style="color:var(--text-primary);">${l.action}</strong>: ${l.details}
                        </div>
                    `).join('') || '<p style="text-align:center;padding:2rem;color:var(--text-tertiary);font-size:clamp(0.75rem, 1.3vw, 0.85rem);">Nenhum log registrado.</p>';
                }
            },

            renderChatLogs() {
                const container = document.getElementById('chatLogsContainer');
                if (container) {
                    container.innerHTML = this.state.chatLogs.map(l => `
                        <div style="padding:clamp(0.5rem, 1.5vw, 0.75rem);border-bottom:1px solid var(--border-light);font-size:clamp(0.7rem, 1.3vw, 0.8rem);">
                            <span style="color:var(--text-tertiary);">${l.time}</span> | 
                            <strong>${l.user}</strong> -> <strong>${l.agent}</strong>: ${l.message}
                        </div>
                    `).join('') || '<p style="text-align:center;padding:2rem;color:var(--text-tertiary);font-size:clamp(0.75rem, 1.3vw, 0.85rem);">Nenhum chat auditado.</p>';
                }
            },

            clearLogs() {
                if (confirm('Limpar todos os logs do sistema?')) {
                    this.state.systemLogs = [];
                    localStorage.removeItem('tico_system_logs');
                    this.renderSystemLogs();
                    this.notify('info', 'Logs Limpos', 'O histórico de auditoria foi reiniciado.');
                }
            },

            resetAllData() {
                if (confirm('ATENÇÃO: Isso apagará todos os seus dados. Continuar?')) {
                    localStorage.clear();
                    location.reload();
                }
            },

            notify(type, title, message) {
                const container = document.getElementById('notificationContainer');
                const div = document.createElement('div');
                div.className = `notification ${type}`;
                const icons = { success: 'fa-check-circle', error: 'fa-exclamation-circle', info: 'fa-info-circle' };
                div.innerHTML = `<i class="fas ${icons[type]}"></i><div><p style="font-weight:700;">${title}</p><p style="opacity:0.9;">${message}</p></div>`;
                container.appendChild(div);
                setTimeout(() => { div.style.opacity = '0'; div.style.transform = 'translateX(100%)'; setTimeout(() => div.remove(), 300); }, 4000);
            },

            exportToCsv() {
                let csv = 'Agente,Setor,Status,Desempenho,Requisicoes\n';
                this.state.agents.forEach(a => { csv += `${a.name},${a.sector},${a.status},${a.performance}%,${a.requests}\n`; });
                const blob = new Blob([csv], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.setAttribute('hidden', '');
                a.setAttribute('href', url);
                a.setAttribute('download', 'tico_ia_report.csv');
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                this.notify('success', 'Exportação Concluída', 'O relatório CSV foi gerado.');
            },

            initCharts() {
                const isDark = this.state.theme === 'dark';
                const textColor = isDark ? '#d4d4d4' : '#404040';
                const gridColor = isDark ? 'rgba(255,255,255,0.05)' : 'rgba(0,0,0,0.05)';
                const chartColors = [
                    'rgba(59, 130, 246, 0.8)',
                    'rgba(16, 185, 129, 0.8)',
                    'rgba(245, 158, 11, 0.8)',
                    'rgba(239, 68, 68, 0.8)',
                    'rgba(139, 92, 246, 0.8)',
                    'rgba(236, 72, 153, 0.8)'
                ];

                // Destruir gráficos existentes
                Object.values(this.state.charts).forEach(chart => {
                    if (chart && typeof chart.destroy === 'function') {
                        chart.destroy();
                    }
                });

                // Gráfico de Requisições
                const ctxLine = document.getElementById('requestsChart');
                if (ctxLine) {
                    this.state.charts.requests = new Chart(ctxLine.getContext('2d'), {
                        type: 'line',
                        data: {
                            labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                            datasets: [{
                                label: 'Requisições',
                                data: this.state.chartData.line,
                                borderColor: chartColors[0],
                                backgroundColor: chartColors[0].replace('0.8', '0.1'),
                                fill: true,
                                tension: 0.4,
                                borderWidth: 2
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { 
                                legend: { 
                                    display: false 
                                },
                                tooltip: {
                                    mode: 'index',
                                    intersect: false,
                                    backgroundColor: isDark ? 'rgba(0,0,0,0.8)' : 'rgba(255,255,255,0.9)',
                                    titleColor: textColor,
                                    bodyColor: textColor
                                }
                            },
                            scales: {
                                y: { 
                                    grid: { 
                                        color: gridColor,
                                        drawBorder: false
                                    }, 
                                    ticks: { 
                                        color: textColor 
                                    },
                                    beginAtZero: true
                                },
                                x: { 
                                    grid: { 
                                        display: false 
                                    }, 
                                    ticks: { 
                                        color: textColor 
                                    }
                                }
                            }
                        }
                    });
                }

                // Gráfico de Distribuição por Setor
                const ctxPie = document.getElementById('sectorChart');
                if (ctxPie) {
                    this.state.charts.sector = new Chart(ctxPie.getContext('2d'), {
                        type: 'doughnut',
                        data: {
                            labels: ['RH', 'Engenharia', 'Suprimentos', 'ADM'],
                            datasets: [{
                                data: this.state.chartData.pie,
                                backgroundColor: chartColors.slice(0, 4),
                                borderWidth: 0,
                                hoverOffset: 15
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { 
                                    position: 'bottom', 
                                    labels: { 
                                        color: textColor, 
                                        padding: 20, 
                                        font: { 
                                            size: 11 
                                        } 
                                    } 
                                },
                                tooltip: {
                                    backgroundColor: isDark ? 'rgba(0,0,0,0.8)' : 'rgba(255,255,255,0.9)',
                                    titleColor: textColor,
                                    bodyColor: textColor
                                }
                            },
                            cutout: '65%'
                        }
                    });
                }

                // Gráfico de Tempo de Resposta
                const ctxResponse = document.getElementById('responseTimeChart');
                if (ctxResponse) {
                    this.state.charts.responseTime = new Chart(ctxResponse.getContext('2d'), {
                        type: 'bar',
                        data: {
                            labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                            datasets: [{
                                label: 'Tempo (ms)',
                                data: this.state.chartData.responseTime,
                                backgroundColor: chartColors.map(c => c.replace('0.8', '0.6')),
                                borderColor: chartColors,
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { 
                                legend: { 
                                    display: false 
                                }
                            },
                            scales: {
                                y: { 
                                    grid: { 
                                        color: gridColor 
                                    }, 
                                    ticks: { 
                                        color: textColor 
                                    },
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        text: 'Milissegundos',
                                        color: textColor
                                    }
                                },
                                x: { 
                                    grid: { 
                                        display: false 
                                    }, 
                                    ticks: { 
                                        color: textColor 
                                    }
                                }
                            }
                        }
                    });
                }

                // Gráfico de Modelos LLM
                const ctxLlm = document.getElementById('llmChart');
                if (ctxLlm) {
                    this.state.charts.llm = new Chart(ctxLlm.getContext('2d'), {
                        type: 'pie',
                        data: {
                            labels: ['GPT-4', 'GPT-3.5', 'Claude 3', 'Gemini'],
                            datasets: [{
                                data: this.state.chartData.llmModels,
                                backgroundColor: chartColors,
                                borderWidth: 0
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { 
                                    position: 'right', 
                                    labels: { 
                                        color: textColor, 
                                        padding: 15,
                                        font: {
                                            size: 11
                                        }
                                    } 
                                }
                            }
                        }
                    });
                }

                // Gráfico de Economia Acumulada
                const ctxEconomy = document.getElementById('economyChart');
                if (ctxEconomy) {
                    this.state.charts.economy = new Chart(ctxEconomy.getContext('2d'), {
                        type: 'line',
                        data: {
                            labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai'],
                            datasets: [{
                                label: 'Economia (R$)',
                                data: this.state.chartData.economy,
                                borderColor: chartColors[1],
                                backgroundColor: chartColors[1].replace('0.8', '0.1'),
                                fill: true,
                                tension: 0.3,
                                borderWidth: 3
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { 
                                legend: { 
                                    display: false 
                                }
                            },
                            scales: {
                                y: { 
                                    grid: { 
                                        color: gridColor 
                                    }, 
                                    ticks: { 
                                        color: textColor,
                                        callback: function(value) {
                                            return 'R$ ' + value.toLocaleString('pt-BR');
                                        }
                                    },
                                    beginAtZero: true
                                },
                                x: { 
                                    grid: { 
                                        display: false 
                                    }, 
                                    ticks: { 
                                        color: textColor 
                                    }
                                }
                            }
                        }
                    });
                }

                // Gráfico de Status dos Agentes
                const ctxStatus = document.getElementById('statusChart');
                if (ctxStatus) {
                    this.state.charts.status = new Chart(ctxStatus.getContext('2d'), {
                        type: 'polarArea',
                        data: {
                            labels: ['Online', 'Ocupado', 'Offline'],
                            datasets: [{
                                data: this.state.chartData.agentStatus,
                                backgroundColor: [
                                    'rgba(16, 185, 129, 0.7)',
                                    'rgba(245, 158, 11, 0.7)',
                                    'rgba(239, 68, 68, 0.7)'
                                ],
                                borderWidth: 1,
                                borderColor: isDark ? 'rgba(255,255,255,0.1)' : 'rgba(0,0,0,0.1)'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { 
                                    position: 'bottom', 
                                    labels: { 
                                        color: textColor, 
                                        padding: 15 
                                    } 
                                }
                            },
                            scales: {
                                r: {
                                    ticks: {
                                        display: false
                                    },
                                    grid: {
                                        color: gridColor
                                    }
                                }
                            }
                        }
                    });
                }
            }
        };

        document.addEventListener('DOMContentLoaded', () => TicoApp.init());
    </script>
</body>
</html>